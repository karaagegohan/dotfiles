#! /bin/bash

function usage() {
  local _script_name
  _script_name=$(basename $0)
cat <<_EOT_
Usage:
  $_script_name [-a] [-b]

Description:
  Get information about the music playing now.

Options:
  -a    artist
  -t    title
_EOT_
exit 1
}

DISPLAY=""
if [ $# -eq 0 ]; then
  DISPLAY=$DISPLAY osascript -e 'tell application "iTunes" to if player state is playing then name of current track & " - " & artist of current track'
else
  if [ "$OPTIND" = 1 ]; then
    while getopts :abth OPT
    do
      case $OPT in
        a)
          DISPLAY=$DISPLAY osascript -e 'tell application "iTunes" to if player state is playing then name of current track'
          ;;
        t)
          DISPLAY=$DISPLAY osascript -e 'tell application "iTunes" to if player state is playing then artist of current track'
          ;;
        b)
          DISPLAY=$DISPLAY osascript -e 'tell application "iTunes" to if player state is playing then "1"'
          ;;
        h)
          usage
          ;;
        *)
          usage
          ;;
      esac
    done
  fi
fi

echo $DISPLAY
