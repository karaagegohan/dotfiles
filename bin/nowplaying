#!/usr/bin/ruby

def width(word)
    return word.chars.map{|c|  c.ascii_only? ? 1 : 2 }.inject(0, &:+)
end

s = `ithief information`
if md = s.match(/playing "(.+?)" by/)
    name = md[1]
    playing = true
else
    name = '-----'
    playing = false
end
if md = s.match(/by (.+?) in/)
    artist = md[1]
else
    artist = '-----'
end
colors = [
    'colour40',
    'colour41',
    'colour42',
    'colour43',
    'colour44',
    'colour45',
]
colors += colors.reverse[1..colors.length-2]

w = 44
s = (name + ' ／ ' + artist)
if width(s) > w
    s = s[0..w - 4] + '...'
elsif
    s = s + ' ' * ( w - width(s) )
end
# if width(s) >= w
#     s += ' ' * 18
#     for i in 0 .. charnum
#         str += s[( Time.now.sec + Time.now.min * 60 + i ) % s.length]
#     end
# else
#     str = s
# end
ret = '#[bg=dark]' + '#[fg=' + colors[playing ? Time.now.sec % colors.length : 0] + ']' + '♪ ' + s + ' #[default]'
puts ret 

